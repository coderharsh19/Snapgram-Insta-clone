(this["webpackJsonpsnapgram-react-app"]=this["webpackJsonpsnapgram-react-app"]||[]).push([[0],{35:function(e,t,n){},43:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var c=n(4),s=n.n(c),a=n(36),o=n.n(a),l=(n(43),n(22)),i=n.n(l),r=n(28),m=n(13),d=s.a.createContext(null),u=n(16),j=n(20),p=n(10),b=(n(50),n(51),n(30)),h=n(37),f=n(24),O=n(3),x=function(e){var t=e.slideUp;return Object(O.jsxs)("ul",{className:"header__menu",children:[Object(O.jsx)("li",{className:"header__menu_items",children:Object(O.jsx)("a",{children:Object(O.jsx)(b.a,{className:"header__icons",onClick:function(){window.scrollTo({top:0,behavior:"smooth"})}})})}),Object(O.jsx)("li",{className:"header__menu_items",children:Object(O.jsx)("a",{children:Object(O.jsx)(b.b,{className:"header__icons inbox",onClick:function(){alert("Feature will be implemented soon")}})})}),Object(O.jsx)("li",{className:"header__menu_items",children:Object(O.jsx)("a",{children:Object(O.jsx)(h.a,{className:"header__icons profile",onClick:function(){alert("Feature will be implemented soon")}})})}),Object(O.jsx)("li",{className:"header__menu_items new_post",children:Object(O.jsx)("a",{children:Object(O.jsx)(f.a,{className:"header__icons",onClick:t})})})]})},g=function(e){var t=e.slideUp,n=e.login,c=e.user,s=e.logout;return Object(O.jsx)("div",{className:"header",children:Object(O.jsxs)("div",{className:"header__inner_container",children:[Object(O.jsx)(j.b,{to:"/",children:Object(O.jsx)("h1",{children:"Snapgram"})}),c?Object(O.jsxs)("nav",{className:"header__nav",children:[Object(O.jsx)(x,{slideUp:t}),Object(O.jsxs)("div",{className:"header__nav_profile",children:[Object(O.jsx)("p",{style:{fontWeight:"600",userSelect:"none"},children:c?"Hello, ".concat(c.displayName):" "}),Object(O.jsx)("a",{className:"btn header__logout_btn",onClick:s,children:"Logout"})]})]}):Object(O.jsx)("a",{className:" btn header__login_btn",onClick:n,children:"Log-in/Sign-Up"})]})})},_=n(25),v=u.a.initializeApp({apiKey:"AIzaSyC03hYQihgWdUrN9kSGvwidfbYVhUkiGGA",authDomain:"snapgram-43830.firebaseapp.com",projectId:"snapgram-43830",storageBucket:"snapgram-43830.appspot.com",messagingSenderId:"723093481176",appId:"1:723093481176:web:eb2eced8141c8e371099ad"}),N=u.a.auth(),S=v.firestore(),U=u.a.storage(),I=U.ref(),C=new u.a.auth.GoogleAuthProvider,y=function(e){var t=e.username,n=e.comment,s=e.commentId,a=e.postId,o=Object(c.useContext)(d);return Object(O.jsxs)("div",{className:"comment",children:[Object(O.jsx)("h3",{className:"comment__username",children:t}),Object(O.jsx)("p",{className:"comment__text",children:n}),o&&o.email.replace("@gmail.com","")===t?Object(O.jsx)(_.a,{className:"comment__delete",onClick:function(){S.collection("posts").doc(a).collection("comments").doc(s).delete()}}):""]})},w=function(e){var t=e.id,n=e.user,s=(e.comments,Object(c.useState)("")),a=Object(m.a)(s,2),o=a[0],l=a[1];return Object(O.jsxs)("form",{className:"comment_form",children:[Object(O.jsx)("textarea",{name:"",id:"",cols:"15",rows:"3",className:"comment_form__input",placeholder:"Type your comment here...",value:o,onChange:function(e){l(e.target.value)}}),Object(O.jsx)("button",{type:"submit",className:"comment_form__button",onClick:function(e){e.preventDefault(),S.collection("posts").doc(t).collection("comments").add({username:n.email.replace("@gmail.com",""),comment:o,timestamp:u.a.firestore.FieldValue.serverTimestamp()}).then((function(){l(""),console.log("Comment added to db")})).catch((function(e){console.log(e)}))},children:"Post"})]})},k=function(e){var t=e.username,n=e.caption,s=e.uploadedImage,a=e.userPhoto,o=e.postId,l=e.getUsername,i=e.imageName,r=Object(c.useContext)(d),u=Object(c.useState)([]),p=Object(m.a)(u,2),b=p[0],h=p[1];Object(c.useEffect)((function(){o&&S.collection("posts").doc(o).collection("comments").orderBy("timestamp").onSnapshot((function(e){h(e.docs.map((function(e){return{comment:e.data(),commentId:e.id}})))}))}),[o]);return Object(O.jsxs)("div",{className:"single_post",children:[Object(O.jsxs)("div",{className:"single_post__header",children:[Object(O.jsx)("img",{src:a,alt:"user",className:"single_post__thumbnail"}),Object(O.jsx)(j.b,{to:{pathname:"/".concat(t)},children:Object(O.jsx)("h3",{className:"single_post__username",onClick:l,children:t})}),Object(O.jsx)("div",{className:"single_post__delete",children:r&&r.email.replace("@gmail.com","")===t?Object(O.jsx)(_.a,{onClick:function(){I.child("images/".concat(i)).delete().then((function(){console.log("Uploaded image also deleted")})).catch((function(e){console.log(e)})),S.collection("posts").doc(o).delete().then((function(){console.log("Post  deleted ")})).catch((function(e){console.log(e)}))},style:{fontSize:"23px",cursor:"pointer"}}):""})]}),Object(O.jsxs)("div",{className:"single_post__data",children:[Object(O.jsx)("img",{src:s,alt:"random",className:"single_post__image"}),Object(O.jsxs)("div",{className:"single_post__caption__container",children:[Object(O.jsx)("h3",{className:"single_post__username",children:t}),Object(O.jsx)("p",{className:"single_post__caption",children:n})]})]}),Object(O.jsx)("div",{className:"comments__container",children:b?b.map((function(e){var t=e.comment,n=e.commentId;return Object(O.jsx)(y,{username:t.username,comment:t.comment,commentId:n,postId:o},n)})):""}),r?Object(O.jsx)(w,{id:o,user:r,comments:b},o):""]})},P=(n(35),function(e){var t=e.profileUser,n=Object(c.useContext)(d),s=Object(c.useState)([]),a=Object(m.a)(s,2),o=a[0],l=a[1];return Object(c.useEffect)((function(){S.collection("posts").where("username","==",t).onSnapshot((function(e){l(e.docs.map((function(e){return{postId:e.id,post:e.data()}})))}))}),[t]),Object(O.jsx)("section",{className:"posts",style:{filter:n?"blur(0px)":"blur(6px)",userSelect:n?"":"none"},children:o.map((function(e){var t=e.postId,n=e.post;return Object(O.jsx)(k,{postId:t,uploadedImage:n.uploadedImage,caption:n.caption,username:n.username,userPhoto:n.userPhoto},t)}))})}),A=function(e){var t=e.getUsername,n=Object(c.useContext)(d),s=Object(c.useState)([]),a=Object(m.a)(s,2),o=a[0],l=a[1];return Object(c.useEffect)((function(){S.collection("posts").orderBy("timestamp","desc").onSnapshot((function(e){l(e.docs.map((function(e){return{postId:e.id,post:e.data()}})))}))}),[]),Object(O.jsx)("section",{className:"posts",style:{filter:n?"blur(0px)":"blur(6px)",userSelect:n?"":"none"},children:o.map((function(e){var n=e.postId,c=e.post;return Object(O.jsx)(k,{postId:n,uploadedImage:c.uploadedImage,caption:c.caption,username:c.username,userPhoto:c.userPhoto,getUsername:t,imageName:c.imageName},n)}))})},B=(n(57),function(e){var t=e.slideUpload,n=e.setSlideUpload,s=Object(c.useContext)(d),a=Object(c.useState)(""),o=Object(m.a)(a,2),l=o[0],i=o[1],r=Object(c.useState)(null),j=Object(m.a)(r,2),p=j[0],b=j[1],h=Object(c.useState)(0),x=Object(m.a)(h,2),g=x[0],_=x[1],v=Object(c.useState)(""),N=Object(m.a)(v,2),I=N[0],C=N[1];return Object(O.jsx)("section",{className:t?"upload":"slide",children:Object(O.jsxs)("form",{action:"",children:[Object(O.jsx)("label",{htmlFor:"fileUpload",children:Object(O.jsx)(f.a,{style:{fontSize:"1.5rem",color:"#ff6c0c"}})}),Object(O.jsx)("input",{id:"fileUpload",type:"file",size:"60",onChange:function(e){e.target.files[0]&&(b(e.target.files[0]),C("Selected image: ".concat(e.target.files[0].name)))},accept:"image/*"}),Object(O.jsx)("textarea",{value:l,onChange:function(e){i(e.target.value)},rows:"6",cols:"50",className:"upload__caption",placeholder:"What's on your mind?"}),Object(O.jsx)("button",{className:"upload__button",onClick:function(e){(e.preventDefault(),p)&&U.ref("/images/".concat(p.name)).put(p).on("state_changed",(function(e){var t=Math.floor(Math.round(e.bytesTransferred/e.totalBytes*100));_(t)}),(function(e){console.log(e.message)}),(function(){U.ref("images").child("".concat(p.name)).getDownloadURL().then((function(e){S.collection("posts").add({timestamp:u.a.firestore.FieldValue.serverTimestamp(),caption:l,username:s.email.replace("@gmail.com",""),uploadedImage:e,userPhoto:s.photoURL,imageName:p.name})})),i(""),C(""),_(0),b("null"),n(!t)}))},children:"Post"}),Object(O.jsx)("h1",{className:"upload__progress",children:0!==g?g:""}),Object(O.jsx)("p",{id:"file_name",children:I})]})})}),F=function(){return Object(O.jsx)("div",{className:"welcome",style:{marginBottom:"70px",height:"60vh",display:"flex",alignItems:"center",justifyContent:"center"},children:Object(O.jsx)("h1",{className:"Welcome__text",style:{fontWeight:"300"},children:"Please login to comment or explore posts"})})},T=function(e){var t=e.user,n=e.slideUpload,c=e.getUsername,s=e.setSlideUpload;return Object(O.jsxs)(O.Fragment,{children:[t&&n?Object(O.jsx)(B,{slideUpload:n,setSlideUpload:s}):"",t?Object(O.jsx)(A,{getUsername:c}):Object(O.jsx)(F,{})]})};var W=function(){var e=Object(c.useState)(!1),t=Object(m.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(null),o=Object(m.a)(a,2),l=o[0],b=o[1],h=Object(c.useState)(""),f=Object(m.a)(h,2),x=f[0],_=f[1];Object(c.useEffect)((function(){N.onAuthStateChanged((function(e){b(e||null)}))}),[l]);var v=function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.signOut();case 3:console.log("Signout successful"),b(null),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(O.jsx)(d.Provider,{value:l,children:Object(O.jsx)(j.a,{children:Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)(g,{slideUp:function(){s(!n)},login:function(){u.a.auth().setPersistence("session").then(Object(r.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.auth().signInWithPopup(C);case 2:t=e.sent,n=t.user,b(n);case 5:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e)}))},user:l,logout:v}),Object(O.jsx)(p.c,{children:Object(O.jsx)(p.a,{path:"/",exact:!0,children:Object(O.jsx)(T,{user:l,slideUpload:n,getUsername:function(e){_(e.target.innerText),console.log(x)},setSlideUpload:s})})}),Object(O.jsx)(p.c,{children:Object(O.jsx)(p.a,{path:"/:id",exact:!0,children:Object(O.jsx)(P,{profileUser:x.toLowerCase()})})})]})})})};o.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(W,{})}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.a6605663.chunk.js.map